<!DOCTYPE html>
<html lang="en">
<meta charset="utf-8">
<title>Dependency Web</title>
<style>
html, body {
  width: 100%;
  height: 100%;
}
div#graph {
  width: 90%;
  height: 90%;
}
.node {
  stroke: #fff;
  stroke-width: 1.5px;
}

.link {
  stroke: #999;
  stroke-opacity: .6;
}
.textnode {
  stroke: #000;
  stroke-width: 0em;
}
</style>
<body>
<script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>

<script src="http://d3js.org/d3.v3.min.js"></script>
<script src="./deb_build.js" type="text/javascript"></script>
<script src="./depweb_graph.js" type="text/javascript"></script>
<script>
/*
  somewhat modified from the d3js example http://bl.ocks.org/mbostock/4062045
*/
var myg;
$(document).ready(function() {  
  $.get('./data.json', function(d) {
    var width = $('body')[0].clientWidth*.9;
    var height = $('body')[0].clientHeight*.9;
    var pd = $depweb.fromArray(d);
    //debugger;
    myg = new $depweb_graph('body', width, height, pd);
  })
})
</script>
<script type="text/javascript">
  setTimeout(function() {
    console.log(new Date());
    (function() { var n = new $depweb.node("A night in", 1, ["Home", "Netflix"]); myg.addData(n); })();
  }, 3000 );

  setTimeout(function() {
    console.log(new Date());
    (function() { var n = myg.data.nodesByName["A night in"]; n.needs.push("Dragon"); myg.updateData(n); })();
  }, 5000);

  setTimeout(function() {
    console.log(new Date());
    console.log("delete link ");
    (function() { var n = myg.data.nodesByName["A night in"]; n.needs = n.needs.filter(function(d){ return (d != "Dragon"); }); console.log("new n needs", n.needs); myg.updateData(n); })();
  }, 10000);
</script>
</body>
</html>
